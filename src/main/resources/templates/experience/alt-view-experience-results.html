<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    
    <!-- Can have dynamic title, unsure on how this would want to be styled -->

    <title>Search Results</title>

    <style>
        .navbar-custom {
            background-color: #020061;
        }

        .navbar-custom,
        .navbar-brand,
        .navbar-custom,
        .navbar-nav,
        .nav-link {
            color: #ffffff;
        }
    </style>

</head>

<body>
    <header>
    
        <nav class="navbar navbar-expand-lg navbar-custom">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <img th:src="@{/images/samplelogo.png}" src="../static/images/samplelogo.png"
                         class="d-inline-block align-top" alt="">
                </a>
    
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" th:href="@{/home}" href="/home.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Experiences</a>
                    </li>
                </ul>
    
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/login}" href="login.html">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/registration}" href="registration.html">Register</a>
                    </li>
                </ul>
    
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-secondary" type="submit">Search</button>
                </form>
    
    
            </div>
        </nav>
    </header>

    <main class="container">
        <form class="row mt-5" th:action="@{/experience/search}" th:object="${searchForm}" action="#" method="get"
              class="row gx-0 mx-auto justify-content-center" id="searchForm" novalidate>
            <div class="col-9 col-lg">
                <input th:value="*{locationText}" type="search" id="acLocationInput" placeholder="Location"
                       aria-label="Location" class="form-control mb-1 rounded-end-0" maxlength="1000">
            </div>
            <input th:value="*{locationText}" type="hidden" name="locationText">
            <input th:value="*{locationLat}" type="hidden" name="locationLat">
            <input th:value="*{locationLng}" type="hidden" name="locationLng">
            <div class="col-3 col-lg-auto">
                <select name="distanceMiles" aria-label="Distance" class="form-select rounded-start-0">
                    <option value="1" th:selected="*{distanceMiles == 1}">1 mile</option>
                    <option value="5" th:selected="*{distanceMiles == 5}">5 miles</option>
                    <option value="25" th:selected="*{distanceMiles == 25}">25 miles</option>
                    <option value="100" th:selected="*{distanceMiles == 100}">100 miles</option>
                    <option value="500" th:selected="*{distanceMiles == 500}">500 miles</option>
                </select>
            </div>
            <!--
             Create full-width dummy div to force row to break at <lg screen sizes
             At lg+, set display = none to disable
             https://getbootstrap.com/docs/5.3/utilities/display/
             -->
            <div class="w-100 d-lg-none"></div>
            <div class="col-9 col-lg">
                <input th:value="*{keywords}" type="search" name="keywords" placeholder="Keywords" aria-label="Keywords"
                       class="form-control rounded-end-0" spellcheck="true" maxlength="100">
            </div>
            <div class="col-3 col-lg-auto">
                <button type="submit" class="btn btn-success w-100 rounded-start-0 m-0" style="white-space: nowrap">
                    <i class="bi bi-search"></i> Search
                </button>
            </div>
        </form>
    
        <div class="row justify-content-between my-4">
            
            <!-- Also unsure if this should have dynamic text served to it -->

            <h1 class="col">Results —</h1>
    
        </div>
    
        <div class="row justify-content-center">
            
            <!-- There is a large amount of empty space in the card which I cannot figure out how to remove, I assume this is coming from 
             some portion of the following div not allowing the elements to hit the width exactly -->
            <div th:each="experience : ${searchResult.experiences}" class="card m-4" style="width: 18rem;">
                <img class="card-img-top" 
                     th:src="${experience.imageUrl} ?: @{/images/fallback-picture.png}"
                     th:onerror="|this.src='@{/images/fallback-picture.png}'; this.onerror='';|"
                     class="mw-100 mh-100 object-fit-contain"
                     alt="Photo"
                     src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Hollywood_Sign_%28Zuschnitt%29.jpg/2560px-Hollywood_Sign_%28Zuschnitt%29.jpg">
                <div class="card-body">
                  <h5 class="card-title" th:text="${experience.title}">Experience Title</h5>
                  <div th:if="${experience.description}">
                    <p class="card-text" th:text="${experience.description}">Description</p>
                  </div>
                </div>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item" th:text="${experience.address} ?: ${#numbers.formatDecimal(experience.locationLat, 1, 6)} + ', ' + ${#numbers.formatDecimal(experience.locationLng, 1, 6)}">123 Fake St. City, State Country</li>
                  <li class="list-group-item" th:text="${#temporals.format(experience.eventDate)}">January 1, 2025</li>
                  <li class="list-group-item" th:if="${experience.ratingCnt == 0}">No Ratings</li>
                  <li class="list-group-item" th:if="${experience.ratingCnt > 0}" th:text="${rating}">4.67 / 5.0</li>
                </ul>
                <div class="card-body">
                    <a href="#" class="btn btn-primary">View Experience</a>
                </div>
            </div>
            
        </div>
    
        <div th:if="${!searchResult.hasNext}" class="row text-center mt-5">
            <h6>End of results</h6>
        </div>
    </main>


    <footer class="mt-auto">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3">
            <li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">Contact Us</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-body-secondary">Privacy Policy</a></li>
        </ul>
        <p class="text-center text-body-secondary">Group Travel Planner Project © 2025</p>
    </footer>
    
    </body>
    </html>